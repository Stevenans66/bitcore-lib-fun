(this["webpackJsonpbrowser-wallet"]=this["webpackJsonpbrowser-wallet"]||[]).push([[0],{181:function(t,e,n){"use strict";(function(t){var r=n(341);Object.defineProperty(e,"__esModule",{value:!0}),e.pushdata=function(e){if(0===e.length)return t.from([76,0]);if(e.length<78)return t.concat([t.from([e.length]),e]);if(e.length<255)return t.concat([t.from([76,e.length]),e]);if(e.length<65535){var n=t.allocUnsafe(2);return n.writeUInt16LE(e.length,0),t.concat([t.from([77]),n,e])}if(e.length<4294967295){var r=t.allocUnsafe(4);return r.writeUInt32LE(e.length,0),t.concat([t.from([78]),r,e])}throw new Error("does not support bigger pushes yet")},e.BNToInt64BE=function(e){if(!e.isInteger())throw new Error("bn not an integer");if(!e.isPositive())throw new Error("bn not positive integer");var n=e.toString(16);if(n.length>16)throw new Error("bn outside of range");return t.from(n.padStart(16,"0"),"hex")},e.createOpReturnGenesis=function(n,r,s,a,i,o,c,u){if(![1,65,129].includes(n))throw new Error("unknown versionType");if("string"===typeof i){if(0!==i.length&&64!==i.length)throw new Error("documentHash must be either 0 or 32 hex bytes");if(64===i.length&&!i.match(/^[0-9a-fA-F]{64}$/))throw new Error("documentHash must be hex");i=t.from(i,"hex")}else if(0!==i.length&&32!==i.length)throw new Error("documentHash must be either 0 or 32 hex bytes");if(o<0||o>9)throw new Error("decimals out of range");if(null!==c&&(c<2||c>255))throw new Error("mintBatonVout out of range (0x02 < > 0xFF)");if(65===n){if(!u.isEqualTo(1))throw new Error("quantity must be 1 for NFT1 child genesis");if(0!==o)throw new Error("decimals must be 0 for NFT1 child genesis");if(null!==c)throw new Error("mintBatonVout must be null for NFT1 child genesis")}return t.concat([t.from([106]),e.pushdata(t.from("SLP\0")),e.pushdata(t.from([n])),e.pushdata(t.from("GENESIS")),e.pushdata(t.from(r)),e.pushdata(t.from(s)),e.pushdata(t.from(a)),e.pushdata(i),e.pushdata(t.from([o])),e.pushdata(t.from(null===c?[]:[c])),e.pushdata(e.BNToInt64BE(u))])},e.createOpReturnMint=function(n,r,s,a){if(![1,65,129].includes(n))throw new Error("unknown versionType");if("string"===typeof r){if(!r.match(/^[0-9a-fA-F]{64}$/))throw new Error("tokenIdHex does not pass regex");if(64!==r.length)throw new Error("tokenIdHex must be 32 bytes");r=t.from(r,"hex")}else if(32!==r.length)throw new Error("tokenIdHex must be 32 bytes");if(null!==s&&(s<2||s>255))throw new Error("mintBatonVout out of range (0x02 < > 0xFF)");return t.concat([t.from([106]),e.pushdata(t.from("SLP\0")),e.pushdata(t.from([n])),e.pushdata(t.from("MINT")),e.pushdata(r),e.pushdata(t.from(null===s?[]:[s])),e.pushdata(e.BNToInt64BE(a))])},e.createOpReturnSend=function(n,s,a){if(![1,65,129].includes(n))throw new Error("unknown versionType");if("string"===typeof s){if(!s.match(/^[0-9a-fA-F]{64}$/))throw new Error("tokenIdHex does not pass regex");if(64!==s.length)throw new Error("tokenIdHex must be 32 bytes");s=t.from(s,"hex")}else if(32!==s.length)throw new Error("tokenIdHex must be 32 bytes");if(a.length<1)throw new Error("send requires at least one amount");if(a.length>19)throw new Error("too many slp amounts");return t.concat([t.from([106]),e.pushdata(t.from("SLP\0")),e.pushdata(t.from([n])),e.pushdata(t.from("SEND")),e.pushdata(s)].concat(r(a.map((function(t){return e.pushdata(e.BNToInt64BE(t))})))))}}).call(this,n(2).Buffer)},19:function(t,e,n){"use strict";(function(t){var r=n(16),s=n(18),a=function(){function e(){Object(r.a)(this,e)}return Object(s.a)(e,null,[{key:"hashToTxid",value:function(e){var n=t.from(e).toString("hex"),r=new Uint8Array(n.match(/.{1,2}/g).map((function(t){return parseInt(t,16)}))).reverse();return t.from(r).toString("hex")}},{key:"outpointToKey",value:function(n,r){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=t.alloc(4);return a.writeUInt32BE(r),s?t.from(n).toString("hex")+a.toString("hex"):e.hashToTxid(n)+a.toString("hex")}},{key:"keyToOutpointString",value:function(e){var n=e.slice(0,64),r=e.slice(64,72),s=t.from(r,"hex");return"".concat(n,":").concat(s.readUInt32BE(0))}}]),e}();a.sleep=function(t){return new Promise((function(e){return setTimeout(e,t)}))},e.a=a}).call(this,n(2).Buffer)},195:function(t,e,n){"use strict";(function(t){var r,s=n(25),a=n(0),i=n(4),o=n.n(i),c=n(11),u=n(16),l=n(18),d=n(83),h=n(202),p=n(50),f=n(203),b=n(201),x=n(1),m=n(85),g=(n(215),n(196)),O=n(197),j=n.n(O),v=n(41),T=n.n(v),k=n(8),w=n(49),S=n(9),y=n(58),A=n(204),I=n(19);!function(t){t.LOW_BCH_INPUTS="insufficient bch inputs",t.LOW_SLP_INPUTS="insufficient slp inputs",t.INVALID_OUTPUT_ADDRESS="invalid address",t.NON_SLP_ADDRESS="address isn't slp format",t.INVALID_OUTPUT_AMOUNT="invalid amount",t.BELOW_DUST_LIMIT="output is lower than dust limit",t.ZERO_SLP_OUTPUT="must have slp output > 0",t.TOO_MANY_SLP_DECIMAL_PLACES="too many decimal places for this slp token"}(r||(r={}));var C={border:"2px solid grey",marginLeft:"auto",marginRight:"auto"},E=function(e){Object(f.a)(i,e);var n=Object(b.a)(i);function i(t){var e;return Object(u.a)(this,i),(e=n.call(this,t)).domWallet=new A.a(Object(d.a)(e)),e.mounted=!1,e.validateAddOutput=function(){T.a.isValidAddress(e.state.outputAddressValue)?(e.state.txnValidationErrors.delete(r.INVALID_OUTPUT_ADDRESS),"bch"===e.state.selectedSlpTokenId||T.a.isSlpAddress(e.state.outputAddressValue)?"bch"!==e.state.selectedSlpTokenId&&e.state.txnValidationErrors.delete(r.NON_SLP_ADDRESS):e.state.txnValidationErrors.add(r.NON_SLP_ADDRESS)):(e.state.txnValidationErrors.add(r.INVALID_OUTPUT_ADDRESS),e.state.txnValidationErrors.delete(r.NON_SLP_ADDRESS));try{Object(k.Big)(e.state.outputAmountValue),e.state.txnValidationErrors.delete(r.INVALID_OUTPUT_AMOUNT)}catch(h){e.state.txnValidationErrors.add(r.INVALID_OUTPUT_AMOUNT)}var t=e.state.currentTxn;if("bch"===e.state.selectedSlpTokenId)if(e.state.outputAmountValue&&Object(k.Big)(e.state.outputAmountValue).lt(546)?e.state.txnValidationErrors.add(r.BELOW_DUST_LIMIT):e.state.txnValidationErrors.delete(r.BELOW_DUST_LIMIT),e.state.outputAmountValue){var n=Array.from(e.domWallet.Wallet.BchCoins).reduce((function(t,e,n){return t.add(e[1].satoshis)}),Object(k.Big)(0));t.Outputs.reduce((function(t,e,n){return t.add(e[0].satoshis)}),Object(k.Big)(0)).add(e.state.outputAmountValue).gt(n)?e.state.txnValidationErrors.add(r.LOW_BCH_INPUTS):e.state.txnValidationErrors.delete(r.LOW_BCH_INPUTS)}else e.state.txnValidationErrors.delete(r.LOW_BCH_INPUTS);else if(e.state.txnValidationErrors.delete(r.BELOW_DUST_LIMIT),e.state.txnValidationErrors.delete(r.LOW_BCH_INPUTS),e.state.outputAmountValue){var s=e.getTokenAmount(new k.Big(e.state.outputAmountValue),e.state.selectedSlpTokenId);e.state.outputAmountValue&&s.lt(1)?e.state.txnValidationErrors.add(r.ZERO_SLP_OUTPUT):e.state.txnValidationErrors.delete(r.ZERO_SLP_OUTPUT);var a=e.state.selectedSlpTokenId,i=e.domWallet.Wallet.SlpCoins.get(a),o=Array.from(i).reduce((function(t,e,n){return t.add(e[1].amount)}),Object(k.Big)(0)),c=e.state.currentTxn.SlpChangeOutput?e.state.currentTxn.SlpChangeOutput.amount:0;t.SlpOutputs.reduce((function(t,e,n){return t.add(e)}),Object(k.Big)(0)).add(s).sub(c).gt(o)?e.state.txnValidationErrors.add(r.LOW_SLP_INPUTS):e.state.txnValidationErrors.delete(r.LOW_SLP_INPUTS);var u=e.state.currentTxn.SlpChangeOutput?y.a:0,l=42+9*t.SlpOutputs.length,d=Array.from(e.domWallet.Wallet.BchCoins).reduce((function(t,e,n){return t.add(e[1].satoshis)}),Object(k.Big)(0));t.Outputs.reduce((function(t,e,n){return t.add(e[0].satoshis)}),Object(k.Big)(0)).add(y.a).add(u).add(l).gt(d)?e.state.txnValidationErrors.add(r.LOW_BCH_INPUTS):e.state.txnValidationErrors.delete(r.LOW_BCH_INPUTS),s.lt(1)?e.state.txnValidationErrors.add(r.TOO_MANY_SLP_DECIMAL_PLACES):e.state.txnValidationErrors.delete(r.TOO_MANY_SLP_DECIMAL_PLACES)}else e.state.txnValidationErrors.delete(r.LOW_SLP_INPUTS),e.state.txnValidationErrors.delete(r.LOW_BCH_INPUTS),e.state.txnValidationErrors.delete(r.ZERO_SLP_OUTPUT),e.state.txnValidationErrors.delete(r.TOO_MANY_SLP_DECIMAL_PLACES);return e.state.txnValidationErrors.size>0&&e.forceUpdate(),e.state.txnValidationErrors.size},e.updateOutputAddress=function(t){T.a.isValidAddress(t.target.value)?e.setState({outputAddressValid:!0,outputAddressValue:t.target.value}):e.setState({outputAddressValid:!1,outputAddressValue:t.target.value})},e.updateSelectedToken=function(t){var n=t.target.value;n!==e.state.selectedSlpTokenId&&e.setState({currentTxn:new y.b(e.domWallet.Wallet)}),t.target.selectedIndex<e.domWallet.Wallet.TokenMetadata.size?e.setState({selectedSlpTokenId:n}):e.setState({selectedSlpTokenId:"bch"})},e.updateOutputValue=function(t){try{Object(k.Big)(t.target.value)}catch(n){return void e.setState({outputAmountValid:!1,outputAmountValue:t.target.value})}Object(k.Big)(t.target.value).lt(546)?e.setState({outputAmountValid:!1,outputAmountValue:t.target.value}):e.setState({outputAmountValid:!0,outputAmountValue:t.target.value})},e.clearTransaction=function(){e.state.txnValidationErrors.clear(),e.setState({outputAddressValue:"",outputAmountValue:"",currentTxn:new y.b(e.domWallet.Wallet),selectedSlpTokenId:"bch"})},e.sendTransaction=Object(c.a)(o.a.mark((function t(){var n,r,s,a,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.state.currentTxn.SignTransaction((function(){return e.domWallet.Wallet.PrivateKey}));case 3:return n=t.sent,r=n.txnHex,s=n.fee,a=n.sendAmount,console.log(r),t.next=10,Object(m.b)("Send: ".concat(a," satoshis with fee: ").concat(s," satoshis?"));case 10:if(!t.sent){t.next=19;break}return t.next=14,e.domWallet.Wallet.SendTransaction(r);case 14:return i=t.sent,t.next=17,Object(m.a)("Broadcasted: ".concat(i));case 17:e.clearTransaction(),e.forceUpdate();case 19:t.next=25;break;case 21:return t.prev=21,t.t0=t.catch(0),t.next=25,Object(m.a)("Error: ".concat(t.t0.message));case 25:case"end":return t.stop()}}),t,null,[[0,21]])}))),e.addOutput=function(){if(!(e.validateAddOutput()>0)){var t=T.a.toCashAddress(e.state.outputAddressValue),n=Object(k.Big)(e.state.outputAmountValue);switch(e.state.selectedSlpTokenId){case"bch":e.state.currentTxn.AddBchOutput(new S.Address(t),n.toNumber())?e.state.txnValidationErrors.delete(r.LOW_BCH_INPUTS):e.state.txnValidationErrors.add(r.LOW_BCH_INPUTS);break;default:var s=e.getTokenAmount(n,e.state.selectedSlpTokenId);e.state.currentTxn.AddSlpOutput(t,s,e.state.selectedSlpTokenId)}e.forceUpdate()}},e.importMnemonic=function(t){var n=t.target.value;if(n){try{e.domWallet.Wallet.UpdateMnemonic(n)}catch(r){console.log("invalid wif: ".concat(n))}e.setState({address:e.domWallet.Wallet.Address.toCashAddress(),showPrivKey:!1,showSlpAddressFormat:!1}),e.domWallet.Wallet.LoadInitialBalances()}},e.toggleAddrFormat=Object(c.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.domWallet.Wallet.Address.toCashAddress(),e.state.showSlpAddressFormat||(n=T.a.toSlpAddress(n)),e.state.useMainnet||(n=T.a.toTestnetAddress(n)),t.next=5,e.setState({showSlpAddressFormat:!e.state.showSlpAddressFormat,address:n});case 5:case"end":return t.stop()}}),t)}))),e.toggleMnemonic=function(){e.setState({showPrivKey:!e.state.showPrivKey})},e.state={showPrivKey:!1,showSlpAddressFormat:!0,address:T.a.toSlpAddress(e.domWallet.Wallet.Address.toCashAddress()),useMainnet:!0,checkingBalance:!0,showCoins:!1,showTxnInputs:!1,showBchHistory:!1,showSlpHistory:!1,outputAddressValue:"",outputAddressValid:!1,outputAmountValue:"",outputAmountValid:!1,selectedSlpTokenId:"bch",slpOutputs:[],currentTxn:new y.b(e.domWallet.Wallet),txnValidationErrors:new Set},e}return Object(l.a)(i,[{key:"componentDidMount",value:function(){this.mounted=!0,this.domWallet.Wallet.Subscribe()}},{key:"UpdateWalletUI",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var t=this;return Object(a.jsxs)("div",{className:"App",children:[Object(a.jsxs)("header",{className:"App-header",children:[Object(a.jsx)("br",{}),Object(a.jsx)("a",{className:"App-link",href:"https://bch.info",target:"_blank",rel:"noopener noreferrer",children:Object(a.jsx)("img",{src:g.a,className:"App-logo",alt:"logo",width:"30%",height:"30%"})})," ",Object(a.jsx)("h3",{children:"Web Wallet"})]}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)("strong",{children:"Back up your funds with your 12-word seed phase!!!"}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{hidden:!this.state.showPrivKey,children:["Seed Phrase:",Object(a.jsx)("br",{}),Object(a.jsx)("input",{defaultValue:this.domWallet.Wallet.Mnemonic,onChange:this.importMnemonic}),Object(a.jsx)("br",{}),"Xpub:",Object(a.jsx)("br",{}),this.domWallet.Wallet.XPub]}),Object(a.jsxs)("button",{onClick:this.toggleMnemonic,children:[this.state.showPrivKey?"Hide":"Show"," Seed Phrase"]}),Object(a.jsxs)("p",{children:[Object(a.jsx)("strong",{children:"Your wallet address:"}),Object(a.jsx)("br",{}),this.state.address,Object(a.jsx)("br",{}),Object(a.jsxs)("button",{onClick:this.toggleAddrFormat,children:["Switch to ",this.state.showSlpAddressFormat?"cash":"slp","Addr format"]})]}),Object(a.jsx)(j.a,{value:this.state.address}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{hidden:0===this.domWallet.Wallet.SlpCoins.size,children:[Object(a.jsx)("strong",{children:"Balances:"}),Object(a.jsx)("br",{}),Object(a.jsxs)("table",{style:C,children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"name"}),Object(a.jsx)("th",{children:"amount"})]})}),Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:"BCH"}),Object(a.jsx)("td",{children:this.domWallet.Wallet.GetBchBalance().div(Math.pow(10,8)).toFixed(8)})]},"bch-bal"),Array.from(this.domWallet.Wallet.GetSlpBalances()).map((function(e){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:t.getTokenName(e[0])}),Object(a.jsx)("td",{children:t.getSlpAmountString(e[1],e[0])})]},"".concat(e[0],"-bal"))}))]})]})]}),Object(a.jsx)("br",{}),Object(a.jsx)("p",{hidden:0!==this.domWallet.Wallet.SlpCoins.size,children:"No BCH or SLP balance."}),Object(a.jsx)("div",{hidden:0===this.domWallet.Wallet.BchCoins.size,children:Object(a.jsxs)("button",{onClick:function(){return t.setState({showBchHistory:!t.state.showBchHistory})},children:[this.state.showBchHistory?"Hide":"Show"," BCH History"]})}),Object(a.jsx)("div",{hidden:!this.state.showBchHistory,children:"--BCH HISTORY HERE--"}),Object(a.jsx)("br",{}),Object(a.jsx)("div",{hidden:0===this.domWallet.Wallet.SlpCoins.size,children:Object(a.jsxs)("button",{onClick:function(){return t.setState({showSlpHistory:!t.state.showSlpHistory})},children:[this.state.showSlpHistory?"Hide":"Show"," SLP History"]})}),Object(a.jsx)("div",{hidden:!this.state.showSlpHistory,children:"--SLP HISTORY HERE--"}),Object(a.jsx)("br",{}),Object(a.jsx)("div",{hidden:0===this.domWallet.Wallet.BchCoins.size&&0===this.domWallet.Wallet.SlpCoins.size,children:Object(a.jsxs)("button",{onClick:function(){return t.setState({showCoins:!t.state.showCoins})},children:[this.state.showCoins?"Hide":"Show"," Unspent Coins"]})}),Object(a.jsxs)("div",{hidden:!this.state.showCoins,children:[Object(a.jsx)("strong",{children:"Unspent Coins"}),Object(a.jsxs)("table",{style:C,children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"UTXO"}),Object(a.jsx)("th",{children:"Value"}),Object(a.jsx)("th",{children:"Name"})]})}),Object(a.jsxs)("tbody",{children:[Array.from(this.domWallet.Wallet.BchCoins).map((function(t){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:I.a.keyToOutpointString(t[0])}),Object(a.jsx)("td",{children:t[1].satoshis.div(Math.pow(10,8)).toFixed(8)}),Object(a.jsx)("td",{children:"BCH"})]},t[0])})),Array.from(this.domWallet.Wallet.SlpCoins).map((function(e){var n=Object(s.a)(e,2),r=n[0],i=n[1];return Array.from(i).map((function(e){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:I.a.keyToOutpointString(e[0])}),Object(a.jsx)("td",{children:t.getSlpAmountString(e[1].amount,r)}),Object(a.jsx)("td",{children:t.getTokenName(r)})]},e[0])}))}))]})]})]}),Object(a.jsx)("br",{}),Object(a.jsx)("strong",{children:"Create a Transaction"}),Object(a.jsx)("br",{}),Object(a.jsxs)("select",{value:this.state.selectedSlpTokenId,onChange:this.updateSelectedToken,children:[Array.from(this.domWallet.Wallet.SlpCoins).map((function(e){var n=Object(s.a)(e,2),r=n[0];n[1];return Object(a.jsx)("option",{value:r,children:"SLP -> ".concat(t.getTokenName(r)," (").concat(t.getTokenTypeString(r),")")},r)})),Object(a.jsx)("option",{value:"bch",children:"Bitcoin Cash"},"bch")]}),Object(a.jsx)("br",{}),Object(a.jsx)("label",{htmlFor:"payto",children:"PayTo:"}),Object(a.jsx)("br",{}),Object(a.jsx)("input",{id:"payto",value:this.state.outputAddressValue,placeholder:"bch"===this.state.selectedSlpTokenId?"cash or slp address":"slp address",onChange:this.updateOutputAddress}),Object(a.jsx)("br",{}),Object(a.jsx)("label",{htmlFor:"amount",children:"Amount:"}),Object(a.jsx)("br",{}),Object(a.jsx)("input",{id:"amount",value:this.state.outputAmountValue,placeholder:this.getTokenTicker(),onChange:this.updateOutputValue}),Object(a.jsx)("br",{}),Object(a.jsx)("button",{onClick:this.addOutput,children:"Add Output"}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{hidden:0===this.state.txnValidationErrors.size,children:[Object(a.jsx)("br",{}),Object(a.jsx)("strong",{children:"Validation Errors"}),Object(a.jsx)("table",{style:C,children:Object(a.jsx)("tbody",{children:Array.from(this.state.txnValidationErrors).map((function(t,e){return Object(a.jsx)("tr",{children:Object(a.jsx)("td",{children:t})},e)}))})})]}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{hidden:0===this.state.currentTxn.Inputs.length,children:[Object(a.jsxs)("div",{hidden:!this.state.showTxnInputs,children:["Txn Inputs",Object(a.jsx)("table",{style:C,children:Object(a.jsx)("tbody",{children:Array.from(this.state.currentTxn.Inputs).map((function(e,n){var r=I.a.outpointToKey(e.prevTxId,e.outputIndex,!0),s=t.domWallet.Wallet.slpOutpointCache.get(r);return s?Object(a.jsx)("tr",{children:Object(a.jsx)("td",{children:"".concat(e.prevTxId.toString("hex"),":").concat(e.outputIndex,", ").concat(t.getSlpAmountString(s.amount,s.tokenId)," ").concat(t.getTokenTicker(s.tokenId),", ").concat(s.satoshis," sats")})},n):Object(a.jsx)("tr",{children:Object(a.jsx)("td",{children:"".concat(e.prevTxId.toString("hex"),":").concat(e.outputIndex,", ").concat(e.output.satoshis," sats")})},n)}))})})]}),Object(a.jsxs)("button",{onClick:function(){return t.setState({showTxnInputs:!t.state.showTxnInputs})},children:[this.state.showTxnInputs?"Hide":"Show"," Transaction Inputs"]})]}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{hidden:0===this.state.currentTxn.Outputs.length,children:[Object(a.jsx)("strong",{children:"Txn Outputs"}),Object(a.jsx)("table",{style:C,children:Object(a.jsx)("tbody",{children:Array.from(this.state.currentTxn.Outputs).map((function(e,n){if(e[0].script.isDataOut())return Object(a.jsx)("tr",{children:Object(a.jsx)("td",{children:"SLP Metadata message, ".concat(e[0].script.toBuffer().length," bytes, ").concat(e[0].satoshis," sats")})},n);var r=t.state.currentTxn.SlpOutputs;return n<=r.length?Object(a.jsx)("tr",{children:Object(a.jsx)("td",{children:"".concat(e[0].script.toAddress().toCashAddress(),", ").concat(t.getSlpAmountString(r[n-1])," ").concat(t.getTokenTicker(),", ").concat(e[0].satoshis," sats")})},n):Object(a.jsx)("tr",{children:Object(a.jsx)("td",{children:"".concat(e[0].script.toAddress().toCashAddress(),", ").concat(e[0].satoshis," sats")})},n)}))})}),Object(a.jsx)("br",{})]}),Object(a.jsx)("br",{}),Object(a.jsx)("div",{hidden:0===this.state.currentTxn.Outputs.length||0!==this.state.txnValidationErrors.size,children:Object(a.jsx)("button",{onClick:this.sendTransaction,children:"Send"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:this.clearTransaction,children:"Clear"})}),Object(a.jsx)("br",{})]})}},{key:"setState",value:function(t){var e=this;return new Promise((function(n){Object(h.a)(Object(p.a)(i.prototype),"setState",e).call(e,t,n)}))}},{key:"getTokenAmount",value:function(t,e){var n,r=this.domWallet.Wallet.TokenMetadata.get(e);if(r.hasType1())n=r.getType1().getDecimals();else if(r.hasNft1Group())n=r.getNft1Group().getDecimals();else{if(!r.hasNft1Child())throw Error("unknown token type");n=0}return t.mul(Math.pow(10,n))}},{key:"getTokenTicker",value:function(e){if(e||(e=this.state.selectedSlpTokenId),"bch"===e)return"satoshis";if(!this.domWallet.Wallet.TokenMetadata.has(e))return"?";var n,r=this.domWallet.Wallet.TokenMetadata.get(e);if(r.hasType1())n=r.getType1().getTokenTicker_asU8();else if(r.hasNft1Group())n=r.getNft1Group().getTokenTicker_asU8();else{if(!r.hasNft1Child())throw Error("unknown token type");n=r.getNft1Child().getTokenTicker_asU8()}return t.from(n).toString("utf8")}},{key:"getTokenName",value:function(e){if("bch"===e)return"Bitcoin Cash";if(!this.domWallet.Wallet.TokenMetadata.has(e))return"".concat(e.slice(0,10),"...").concat(e.slice(54,64));var n,r=this.domWallet.Wallet.TokenMetadata.get(e);if(r.hasType1())n=r.getType1().getTokenName_asU8();else if(r.hasNft1Group())n=r.getNft1Group().getTokenName_asU8();else{if(!r.hasNft1Child())throw Error("unknown token type");n=r.getNft1Child().getTokenName_asU8()}return t.from(n).toString("utf8")}},{key:"getTokenTypeString",value:function(t){var e=this.domWallet.Wallet.TokenMetadata.get(t);if(!e)return"?";switch(e.getTypeMetadataCase()){case w.TokenMetadata.TypeMetadataCase.TYPE1:return"Token";case w.TokenMetadata.TypeMetadataCase.NFT1_GROUP:return"NFT Group";case w.TokenMetadata.TypeMetadataCase.NFT1_CHILD:return"NFT";default:return"?"}}},{key:"getSlpAmountString",value:function(t,e){e||(e=this.state.selectedSlpTokenId);var n,r=this.domWallet.Wallet.TokenMetadata.get(e);if(r.hasType1())n=r.getType1().getDecimals();else if(r.hasNft1Group())n=r.getNft1Group().getDecimals();else{if(!r.hasNft1Child())throw Error("unknown token type");n=0}return t.div(Math.pow(10,n)).toFixed()}}]),i}(x.Component);e.a=E}).call(this,n(2).Buffer)},196:function(t,e,n){"use strict";e.a=n.p+"static/media/logo.a5dd61ec.svg"},198:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r,s=n(16),a=n(18);r=Symbol.iterator;var i=function(){function t(e){Object(s.a)(this,t),this.set=new Set,this.list=[],this.maxSize=void 0,this.maxSize=e}return Object(a.a)(t,[{key:r,value:function(){return this.list.values()}},{key:"push",value:function(t){return this.set.add(t),this.maxSize>0&&this.set.size>this.maxSize&&this.shift(),this.list.push(t)}},{key:"has",value:function(t){return this.set.has(t)}},{key:"delete",value:function(t){this.set.delete(t)&&(this.list=this.list.filter((function(e){return e!==t})))}},{key:"toSet",value:function(){return this.set}},{key:"shift",value:function(){var t=this.list.shift();return t&&this.set.delete(t),t}},{key:"pop",value:function(){var t=this.list.pop();return t&&this.set.delete(t),t}},{key:"clear",value:function(){this.list=[],this.set.clear()}},{key:"length",get:function(){return this.list.length}}]),t}()},199:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return l}));var r=n(4),s=n.n(r),a=n(11),i=n(16),o=n(18),c=n(42),u=n(19),l=function(){function e(t){Object(i.a)(this,e),this.networkUrl=void 0,this.subscriptions={txn:!1,blockInfo:!1,blockData:!1},this.blockHeight=-1,this.networkUrl=t}return Object(o.a)(e,[{key:"SendTransaction",value:function(){var e=Object(a.a)(s.a.mark((function e(n,r){var a,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new c.GrpcClient({url:this.networkUrl}),e.next=3,a.submitTransaction({txnHex:n});case 3:return i=e.sent,r&&r(),e.abrupt("return",t.from(i.getHash_asU8().reverse()).toString("hex"));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"GetTransaction",value:function(){var t=Object(a.a)(s.a.mark((function t(e){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new c.GrpcClient({url:this.networkUrl}),t.next=3,n.getTransaction({hash:e,reversedHashOrder:!0});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"GetTokenMetadata",value:function(){var t=Object(a.a)(s.a.mark((function t(e){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new c.GrpcClient({url:this.networkUrl}),t.next=3,n.getTokenMetadata(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"GetAddressTransactions",value:function(){var t=Object(a.a)(s.a.mark((function t(e,n){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new c.GrpcClient({url:this.networkUrl}),t.next=3,r.getBlockchainInfo();case 3:if(t.sent.getSlpIndex()){t.next=6;break}throw Error("connected bchd does not have slp index enabled");case 6:return t.next=8,r.getAddressTransactions({address:e});case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"Subscribe",value:function(){var t=Object(a.a)(s.a.mark((function t(e,n){var r,i,o,l=this;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=function(){var t=Object(a.a)(s.a.mark((function t(){var i,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!l.subscriptions.txn){t.next=3;break}return console.log("Txn stream already connected"),t.abrupt("return");case 3:return i=new c.GrpcClient({url:l.networkUrl}),t.next=6,i.subscribeTransactions({includeMempoolAcceptance:!0,includeBlockAcceptance:!1,includeSerializedTxn:!1,addresses:e});case 6:(o=t.sent).on("end",function(){var t=Object(a.a)(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l.subscriptions.txn=!1;case 1:return t.next=4,u.a.sleep(500);case 4:return t.prev=4,console.log("[WALLET] trying to re-establish txn data stream..."),t.next=8,r();case 8:return t.abrupt("break",16);case 11:t.prev=11,t.t0=t.catch(4),console.log(t.t0);case 14:t.next=1;break;case 16:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(e){return t.apply(this,arguments)}}()),o.on("data",function(){var t=Object(a.a)(s.a.mark((function t(e){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l.subscriptions.txn=!0,r=e.getUnconfirmedTransaction().getTransaction(),n(r);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),console.log("[WALLET] txn data stream established.");case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=3,r();case 3:return i=function(){var t=Object(a.a)(s.a.mark((function t(){var e,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!l.subscriptions.blockData){t.next=3;break}return console.log("Txn stream already connected"),t.abrupt("return");case 3:return e=new c.GrpcClient({url:l.networkUrl}),t.next=6,e.subscribeBlocks({includeSerializedBlock:!0});case 6:(n=t.sent).on("end",function(){var t=Object(a.a)(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l.subscriptions.blockData=!1;case 1:return t.next=4,u.a.sleep(500);case 4:return t.prev=4,console.log("[WALLET] trying to re-establish block data stream..."),t.next=8,i();case 8:return t.abrupt("break",15);case 11:t.prev=11,t.t0=t.catch(4);case 13:t.next=1;break;case 15:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(e){return t.apply(this,arguments)}}()),n.on("data",function(){var t=Object(a.a)(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l.subscriptions.blockData=!0,console.log("BLOCK found");case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),console.log("[WALLET] block data stream established.");case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=6,i();case 6:return o=function(){var t=Object(a.a)(s.a.mark((function t(){var e,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!l.subscriptions.blockInfo){t.next=3;break}return console.log("Txn stream already connected"),t.abrupt("return");case 3:return e=new c.GrpcClient({url:l.networkUrl}),t.next=6,e.subscribeBlocks();case 6:(n=t.sent).on("end",function(){var t=Object(a.a)(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l.subscriptions.blockInfo=!1;case 1:return t.next=4,u.a.sleep(500);case 4:return t.prev=4,console.log("[WALLET] trying to re-establish block info stream..."),t.next=8,o();case 8:return t.abrupt("break",15);case 11:t.prev=11,t.t0=t.catch(4);case 13:t.next=1;break;case 15:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(e){return t.apply(this,arguments)}}()),n.on("data",function(){var t=Object(a.a)(s.a.mark((function t(e){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l.subscriptions.blockInfo=!0,n=e.getBlockInfo().getHeight(),l.blockHeight=n,console.log("Block found: ".concat(n));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),console.log("[WALLET] block info stream established.");case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=9,o();case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}()}).call(this,n(2).Buffer)},200:function(t,e,n){"use strict";e.a=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,378)).then((function(e){var n=e.getCLS,r=e.getFID,s=e.getFCP,a=e.getLCP,i=e.getTTFB;n(t),r(t),s(t),a(t),i(t)}))}},204:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(16),s=n(84),a=n(18),i=function(){function t(){Object(r.a)(this,t)}return Object(a.a)(t,[{key:"GetSeed",value:function(){return localStorage.getItem("bitcore-fun-seed")}},{key:"SetSeed",value:function(t){return localStorage.setItem("bicore-fun-seed",t)}}]),t}(),o=n(199),c=function t(e,n,a){if(Object(r.a)(this,t),this.Ready=!1,this.Network=new o.a("https://bchd.ny1.simpleledger.io"),this.Wallet=void 0,this.Storage=new i,void 0===window)throw Error("access to 'window' is not available.");n&&(this.Storage=n),a&&(this.Network=a),this.Wallet=new s.a(this.Storage,this.Network,e)}},205:function(t,e,n){"use strict";n.r(e),function(t){var e=n(0),r=n(1),s=n.n(r),a=n(57),i=n.n(a),o=(n(213),n(195)),c=n(200);t.Buffer=n(2).Buffer,i.a.render(Object(e.jsx)(s.a.StrictMode,{children:Object(e.jsx)(o.a,{})}),document.getElementById("root")),Object(c.a)()}.call(this,n(12))},213:function(t,e,n){},215:function(t,e,n){},225:function(t,e){},227:function(t,e){},238:function(t,e){},240:function(t,e){},255:function(t,e){},261:function(t,e){},262:function(t,e){},299:function(t,e){},301:function(t,e){},306:function(t,e){},308:function(t,e){},320:function(t,e){},323:function(t,e){},340:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(181);e.default={genesis:function(t,e,n,s,a,i,o){return r.createOpReturnGenesis(1,t,e,n,s,a,i,o)},mint:function(t,e,n){return r.createOpReturnMint(1,t,e,n)},send:function(t,e){return r.createOpReturnSend(1,t,e)}}},346:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=r(n(180)),a=n(181);e.default={Group:{genesis:function(t,e,n,r,s,i,o){return a.createOpReturnGenesis(129,t,e,n,r,s,i,o)},mint:function(t,e,n){return a.createOpReturnMint(129,t,e,n)},send:function(t,e){return a.createOpReturnSend(129,t,e)}},Child:{genesis:function(t,e,n,r){return a.createOpReturnGenesis(65,t,e,n,r,0,null,new s.default(1))},send:function(t,e){return a.createOpReturnSend(65,t,e)}}}},353:function(t,e){},370:function(t,e){},372:function(t,e){},58:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return g}));var r,s=n(32),a=n(4),i=n.n(a),o=n(11),c=n(70),u=n(16),l=n(18),d=n(8),h=n.n(d),p=n(9),f=n(59),b=n(84),x=n(19),m=546;!function(t){t[t.TokenVersionType1=1]="TokenVersionType1",t[t.TokenVersionType1_NFT_Child=65]="TokenVersionType1_NFT_Child",t[t.TokenVersionType1_NFT_Group=129]="TokenVersionType1_NFT_Group"}(r||(r={}));var g=function(){function e(t){Object(u.a)(this,e),this.wallet=void 0,this.txn=new p.Transaction,this.tokenId="bch",this.slpOpreturnMessage=void 0,this.slpChangeAmt=void 0,this.slpOutputs=new Array,this.wallet=t}return Object(l.a)(e,[{key:"TokenId",get:function(){return this.tokenId}},{key:"SlpOutputs",get:function(){return this.slpChangeAmt?[].concat(Object(c.a)(this.slpOutputs),[this.slpChangeAmt.amount]):this.slpOutputs}},{key:"SlpChangeOutput",get:function(){return this.slpChangeAmt?{amount:h()(this.slpChangeAmt.amount.toFixed()),index:this.slpChangeAmt.index}:null}},{key:"Inputs",get:function(){return this.txn.inputs}},{key:"Outputs",get:function(){var t=this;return this.txn.outputs.map((function(e,n){var r=h()(0);if(n>0&&n-1<t.slpOutputs.length)r.add(t.slpOutputs[n-1]);else if(t.slpChangeAmt&&n===t.slpOutputs.length+1&&(r.add(t.slpChangeAmt.amount),t.slpChangeAmt.index!==n))throw Error("slp change has wrong index");return[e,r]}))}}]),Object(l.a)(e,[{key:"AddSlpOutput",value:function(t,e,n){if(this.tokenId!==n&&(this.slpOutputs=[],this.tokenId=n),"bch"===n)throw Error("can't add slp token with bch token id");this.txn._changeScript=void 0,void 0!==this.txn._changeIndex&&(this.txn.removeOutput(this.txn._changeIndex),this.txn._changeIndex=void 0),this.slpChangeAmt&&(this.txn.removeOutput(this.slpChangeAmt.index),this.slpChangeAmt=void 0);var r=this.slpOutputs.length+1;this.txn.addOutput(new p.Transaction.Output({script:new p.Script(new p.Address(t)),satoshis:m}),r),this.slpOutputs.push(e),this.addSlpInputs(n),this.addBchInputs()}},{key:"AddBchOutput",value:function(t,e){return this.txn.to(t,e),this.addBchInputs()}},{key:"SignTransaction",value:function(){var t=Object(o.a)(i.a.mark((function t(e){var n,r,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:return n=t.sent,this.txn.sign(n),r=this.txn.serialize(),s=this.txn.inputAmount-this.txn.outputAmount,t.abrupt("return",{txnHex:r,fee:s,sendAmount:this.txn.outputAmount});case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"addBchInputs",value:function(){var e=this;this.txn.change(this.wallet.Address.toCashAddress());var n,r=function(){e.txn.feePerByte(1);var t=b.a.GetFeeRate(e.txn);return e.txn.inputAmount>=e.txn.outputAmount&&t>=1},a=Array.from(this.wallet.BchCoins).sort((function(t,e){return t[1].satoshis.sub(e[1].satoshis).toNumber()})),i=Object(s.a)(a);try{for(i.s();!(n=i.n()).done;){var o,c=n.value,u=!1,l=c[0].slice(0,64),d=t.from(c[0].slice(64),"hex").readUInt32BE(0),h=Object(s.a)(this.txn.inputs);try{for(h.s();!(o=h.n()).done;){var f=o.value;if(l===f.prevTxId.toString("hex")&&d===f.outputIndex){u=!0;break}}}catch(x){h.e(x)}finally{h.f()}if(!u){if(this.txn.outputs.length>0&&r())return!0;this.txn.addInput(new p.Transaction.Input.PublicKeyHash({output:new p.Transaction.Output({script:p.Script.buildPublicKeyHashOut(c[1].address),satoshis:c[1].satoshis.toNumber()}),prevTxId:t.from(l,"hex"),outputIndex:d,script:p.Script.empty()})),this.txn.feePerByte(1)}}}catch(x){i.e(x)}finally{i.f()}return r()}},{key:"createMd",value:function(t,e){var n=e.map((function(t){return new f.BN(t.toFixed())}));switch(this.wallet.TokenMetadata.get(t).getTokenType()){case r.TokenVersionType1:return f.TokenType1.send(t,n);case r.TokenVersionType1_NFT_Group:return f.NFT1.Group.send(t,n);case r.TokenVersionType1_NFT_Child:return f.NFT1.Child.send(t,[new f.BN(1)])}}},{key:"addSlpInputs",value:function(e){var n,r=this,a=Array.from(this.wallet.SlpCoins.get(e)).sort((function(t,e){return t[1].amount.sub(e[1].amount).toNumber()})),i=function(){r.slpChangeAmt&&(r.txn.removeOutput(r.slpChangeAmt.index),r.slpChangeAmt=void 0);var t=r.txn.inputs.reduce((function(t,n,s){var a=r.wallet.SlpCoins.get(e);if(!a)return h()(0);var i=x.a.outpointToKey(r.txn.inputs[s].prevTxId,r.txn.inputs[s].outputIndex,!0);return a.has(i)?t.add(a.get(i).amount):t}),h()(0)),n=r.slpOutputs.reduce((function(t,e,n){return t.add(e)}),h()(0));if(t.gt(n)&&(r.slpChangeAmt={amount:t.minus(n),index:r.slpOutputs.length+1},r.txn.addOutput(new p.Transaction.Output({script:new p.Script(r.wallet.Address),satoshis:m}),r.slpChangeAmt.index)),t.gte(n)){r.slpOpreturnMessage&&r.txn.removeOutput(0);var s=r.SlpChangeOutput?[].concat(Object(c.a)(r.slpOutputs),[r.slpChangeAmt.amount]):r.slpOutputs;return r.slpOpreturnMessage=r.createMd(e,s),r.txn.addOutput(new p.Transaction.Output({script:r.slpOpreturnMessage,satoshis:0}),0),!0}return!1},o=Object(s.a)(a);try{for(o.s();!(n=o.n()).done;){var u,l=n.value,d=!1,f=l[0].slice(0,64),b=t.from(l[0].slice(64),"hex").readUInt32BE(0),g=Object(s.a)(this.txn.inputs);try{for(g.s();!(u=g.n()).done;){var O=u.value;if(f===O.prevTxId.toString("hex")&&b===O.outputIndex){d=!0;break}}}catch(j){g.e(j)}finally{g.f()}if(!d){if(this.slpOutputs.length>0&&i())return!0;this.wallet.slpOutpointCache.set(l[0],{amount:l[1].amount,satoshis:l[1].satoshis,address:l[1].address,tokenId:e}),this.txn.addInput(new p.Transaction.Input.PublicKeyHash({output:new p.Transaction.Output({script:p.Script.buildPublicKeyHashOut(l[1].address),satoshis:l[1].satoshis.toNumber()}),prevTxId:t.from(f,"hex"),outputIndex:b,script:p.Script.empty()}))}}}catch(j){o.e(j)}finally{o.f()}return i()}}]),e}()}).call(this,n(2).Buffer)},59:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=r(n(180));e.BN=s.default;var a=r(n(340));e.TokenType1=a.default;var i=r(n(346));e.NFT1=i.default},84:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return g}));var r=n(70),s=n(32),a=n(4),i=n.n(a),o=n(11),c=n(16),u=n(18),l=n(8),d=n(60),h=n(33),p=n(9),f=n(198),b=n(19),x=new f.a(1e5),m="m/44'/245'/0'/0/0",g=function(){function e(t,n,r){var s=this;Object(c.a)(this,e),this.slpOutpointCache=new Map,this.storage=void 0,this.network=void 0,this.parent=void 0,this.mnemonic=void 0,this.privateKey=void 0,this.bchTxi=new Map,this.bchTxo=new Map,this.slpTxi=new Map,this.slpTxo=new Map,this.tokenMetadata=new Map,this.loadingBalance=!1,this.updateParent=function(){s.parent&&s.parent.UpdateWalletUI()},this.storage=t,this.network=n,this.parent=r,this.mnemonic=h.generateMnemonic();var a=d.fromSeed(h.mnemonicToSeedSync(this.Mnemonic)),i=a.derivePath(m);this.privateKey=new p.PrivateKey(i.toWIF()),null===this.storage.GetSeed()?this.storage.SetSeed(this.Mnemonic):(this.mnemonic=this.storage.GetSeed(),i=(a=d.fromSeed(h.mnemonicToSeedSync(this.Mnemonic))).derivePath(m),this.privateKey=new p.PrivateKey(i.toWIF())),this.LoadInitialBalances()}return Object(u.a)(e,null,[{key:"EstimateTxnSize",value:function(t){return t._estimateSize()}},{key:"GetFeeRate",value:function(t){var n=e.EstimateTxnSize(t);console.log("estimated size: ".concat(n));var r=t.inputAmount-t.outputAmount;if(!r||r<0)return 0;var s=r/n;return console.log("estimated fee rate: ".concat(s)),s}}]),Object(u.a)(e,[{key:"isMine",value:function(t){return t===this.Address.toCashAddress()}},{key:"GetChangeOutput",value:function(t){var e=this,n=[];return t.outputs.forEach((function(t){e.isMine(t.script.toAddress().toCashAddress())&&n.push(t)})),n}},{key:"LoadInitialBalances",value:function(){var t=Object(o.a)(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.loadingBalance){t.next=2;break}return t.abrupt("return");case 2:return this.loadingBalance=!0,t.next=5,this.network.GetAddressTransactions(this.Address.toCashAddress());case 5:return e=t.sent,t.next=8,this.indexTransactionIO(e.getConfirmedTransactionsList());case 8:return t.next=10,this.indexTransactionIO(e.getUnconfirmedTransactionsList().map((function(t){return t.getTransaction()})));case 10:this.loadingBalance=!1,this.updateParent();case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"UpdateMnemonic",value:function(t){if(!h.validateMnemonic(t))throw new Error("invalid mnemonic");this.mnemonic=t,localStorage.setItem("bitcore-fun-seed",this.Mnemonic);var e=d.fromSeed(h.mnemonicToSeedSync(this.Mnemonic)).derivePath(m);this.privateKey=new p.PrivateKey(e.toWIF()),this.LoadInitialBalances()}},{key:"GetBchBalance",value:function(){var t=Array.from(this.bchTxi).reduce((function(t,e){return t.add(e[1].satoshis)}),Object(l.Big)(0));return Array.from(this.bchTxo).reduce((function(t,e){return t.add(e[1].satoshis)}),Object(l.Big)(0)).sub(t)}},{key:"GetSlpBalances",value:function(){var t=new Map;return Array.from(this.slpTxi).forEach((function(e){t.set(e[0],Array.from(e[1]).reduce((function(t,e){return t.add(e[1].amount)}),Object(l.Big)(0)))})),Array.from(this.slpTxo).forEach((function(e){var n=t.get(e[0]);n||(n=Object(l.Big)(0));var r=Array.from(e[1]).reduce((function(t,e){return t.add(e[1].amount)}),Object(l.Big)(0));t.set(e[0],r.sub(n))})),t}},{key:"Subscribe",value:function(){var t=this;this.network.Subscribe([this.Address.toCashAddress()],(function(e){t.processNewTransaction(e)}))}},{key:"processNewTransaction",value:function(){var t=Object(o.a)(i.a.mark((function t(e){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=b.a.hashToTxid(e.getHash_asU8()),!x.has(n)){t.next=3;break}return t.abrupt("return");case 3:return x.push(n),console.log("".concat(n)),t.next=7,this.indexTransactionIO([e]);case 7:this.updateParent();case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"SendTransaction",value:function(){var t=Object(o.a)(i.a.mark((function t(e){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.network.SendTransaction(e);case 2:return n=t.sent,t.next=5,this.network.GetTransaction(n);case 5:return r=t.sent,this.processNewTransaction(r.getTransaction()),t.abrupt("return",n);case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"indexTransactionIO",value:function(){var e=Object(o.a)(i.a.mark((function e(n){var a,o,c,u,d,h,f,x,m,g,O,j,v,T,k=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new Set,o=Object(s.a)(n),e.prev=2,o.s();case 4:if((c=o.n()).done){e.next=46;break}u=c.value,d=Object(s.a)(u.getInputsList()),e.prev=7,d.s();case 9:if((h=d.n()).done){e.next=17;break}if(f=h.value,this.Address.toCashAddress().includes(f.getAddress())){e.next=13;break}return e.abrupt("continue",15);case 13:x=b.a.outpointToKey(f.getOutpoint().getHash_asU8(),f.getOutpoint().getIndex()),f.hasSlpToken()?(m=t.from(f.getSlpToken().getTokenId_asU8()).toString("hex"),a.add(m),this.slpTxi.has(m)||this.slpTxi.set(m,new Map),this.slpTxi.get(m).set(x,{amount:Object(l.Big)(f.getSlpToken().getAmount()),address:new p.Address(f.getAddress()),satoshis:Object(l.Big)(f.getValue())})):this.bchTxi.set(x,{satoshis:Object(l.Big)(f.getValue()),address:new p.Address(f.getAddress())});case 15:e.next=9;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),d.e(e.t0);case 22:return e.prev=22,d.f(),e.finish(22);case 25:g=Object(s.a)(u.getOutputsList()),e.prev=26,g.s();case 28:if((O=g.n()).done){e.next=36;break}if((j=O.value).getAddress()&&this.Address.toCashAddress().includes(j.getAddress())){e.next=32;break}return e.abrupt("continue",34);case 32:v=b.a.outpointToKey(u.getHash_asU8(),j.getIndex()),j.hasSlpToken()?(T=t.from(j.getSlpToken().getTokenId_asU8()).toString("hex"),a.add(T),this.slpTxo.has(T)||this.slpTxo.set(T,new Map),this.slpTxo.get(T).set(v,{amount:Object(l.Big)(j.getSlpToken().getAmount()),address:new p.Address(j.getAddress()),satoshis:Object(l.Big)(j.getValue())})):this.bchTxo.set(v,{satoshis:Object(l.Big)(j.getValue()),address:new p.Address(j.getAddress())});case 34:e.next=28;break;case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(26),g.e(e.t1);case 41:return e.prev=41,g.f(),e.finish(41);case 44:e.next=4;break;case 46:e.next=51;break;case 48:e.prev=48,e.t2=e.catch(2),o.e(e.t2);case 51:return e.prev=51,o.f(),e.finish(51);case 54:return e.next=56,this.network.GetTokenMetadata(Object(r.a)(a.keys()));case 56:e.sent.getTokenMetadataList().forEach((function(e){return k.tokenMetadata.set(t.from(e.getTokenId_asU8()).toString("hex"),e)}));case 58:case"end":return e.stop()}}),e,this,[[2,48,51,54],[7,19,22,25],[26,38,41,44]])})));return function(t){return e.apply(this,arguments)}}()},{key:"Mnemonic",get:function(){return this.mnemonic}},{key:"XPub",get:function(){return d.fromSeed(h.mnemonicToSeedSync(this.Mnemonic)).neutered().toBase58()}},{key:"PrivateKey",get:function(){return this.privateKey.toWIF()},set:function(t){if(!h.validateMnemonic(t))throw Error("invalid mnemonic");var e=d.fromSeed(h.mnemonicToSeedSync(this.mnemonic)).derivePath(m);this.privateKey=new p.PrivateKey(e.toWIF()),this.LoadInitialBalances()}},{key:"Address",get:function(){return this.privateKey.toAddress()}},{key:"BchCoins",get:function(){var t=this,e=new Map;return this.bchTxo.forEach((function(n,r){e.set(r,n),t.bchTxi.has(r)&&e.delete(r)})),e}},{key:"SlpCoins",get:function(){var t=this,e=new Map;return this.slpTxo.forEach((function(n,r){var s;if(!e.has(r)){var a=new Map;e.set(r,a)}s=e.get(r);var i=t.slpTxi.get(r);n.forEach((function(e,n){s.set(n,e),t.slpOutpointCache.has(n)||t.slpOutpointCache.set(n,{amount:e.amount,satoshis:e.satoshis,address:e.address,tokenId:r}),i&&i.has(n)&&s.delete(n)}))})),e}},{key:"TokenMetadata",get:function(){return this.tokenMetadata}}]),e}()}).call(this,n(2).Buffer)}},[[205,1,2]]]);
//# sourceMappingURL=main.01188203.chunk.js.map